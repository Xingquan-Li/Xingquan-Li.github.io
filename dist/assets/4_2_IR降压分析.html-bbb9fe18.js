import{_ as p,a as d}from"./Untitled-a35a8f63.js";import{_ as h}from"./plugin-vue_export-helper-c27b6911.js";import{r as n,o as c,c as R,a,w as t,d as i,e,f as s}from"./app-1ed3f6c2.js";const I={},_=s('<p>在本文中，我们将讨论 ASIC 设计中 IR 压降是什么，为什么会出现 IR 压降问题，IR 压降的影响是什么，以及如何分析和预防 IR 压降问题。</p><h2 id="ir-压降问题是什么" tabindex="-1"><a class="header-anchor" href="#ir-压降问题是什么" aria-hidden="true">#</a> IR 压降问题是什么：</h2><p>IR中的 I 是指电流，R 是指电阻，他们相乘就是电压。故 IR drop 就是电压降。</p><p>通俗来讲，<strong>电压降，就是指从芯片源头供电到instance所消耗的电压</strong>，对于flipchip封装形式，就是从bump到instance PG pin的电压降。Instance实际得到的电压就是供电电压减去电压降的部分。比如bump接的外界输入电压Vdd 5V，Vss 0V，这个bump的电压到某一个instance后，可能Vdd只剩4V，Vss变为1V，那么这个instance得到的电压就只有3V，电压降就是2V。IR drop是芯片后端signoff的一项重要内容，必须保证IR drop不能过大，否则芯片可能会因为得不到所需的电压而发生逻辑错误或停止工作。这个IR drop也是会有相应spec要求的，一般会按照供电电压的百分比来定，如果定了10%，对于5V的输入来说，就要求IR drop不能大于0.5V。</p><p>理论来讲，芯片中的电源（VDD 和VSS）通过金属导轨和条纹均匀分布，这被称为电源传输网络（PDN）或电源网格。PDN 中使用的每个金属层具有有限的电阻率。当电流通过电源传输网络时，根据欧姆定律，应用电压的一部分将在 PDN 中降低。图1显示了电源网络中的 IR 压降。任何金属网都可以假设为小 R 和 C 的组合。</p><div style="text-align:center;"><img src="'+p+'" alt="ASIC Flow" width="600"><h5>图1 金属网中的 IR 压降</h5></div><p>如果金属导线的电阻率较高或通过电源网络的电流量较大，则电源传输网络中可能会降低大量电压，导致标准单元可用电压少于实际应用电压量。如果在电源端口施加 V1 电压，并且在具有总电阻 R 的特定网中流动电流 I，则标准单元的另一端可用电压（V2）将为</p>',7),u=s('<br><p>由于电源传输网络中的 IR 压降，有时标准单元或宏单元无法获得所需的最小工作电压来使其运行，即使在电源端口施加足够的电压。在到达标准单元之前电源传输网络中的电压降称为 IR 压降。</p><p>这种降低可能导致芯片性能不佳，因为标准单元的延迟增加，可能导致芯片功能故障，从而产生建立/保持时间违规。为避免此问题，必须进行 IR 分析，并在设计周期中考虑其在时序分析中的影响。</p><h2 id="ir-压降的类型" tabindex="-1"><a class="header-anchor" href="#ir-压降的类型" aria-hidden="true">#</a> IR 压降的类型</h2><p>ASIC 设计中有两种类型的 IR 压降：</p><ul><li>静态 IR 压降</li><li>动态 IR 压降</li></ul><h3 id="静态-ir-压降" tabindex="-1"><a class="header-anchor" href="#静态-ir-压降" aria-hidden="true">#</a> 静态 IR 压降</h3><p>静态 IR 压降是指当没有输入切换时（即电路处于静态阶段）电源传输网络（PDN）中的电压降。静态IR drop现象产生的原因主要是电源网络的金属连线的分压，是由于金属连线的自身电阻分压造成的。所以<strong>静态IR drop主要跟电源网络的结构和连线细节有关。</strong> 因此静态IR drop主要考虑电阻效应，分析电阻的影响即可。静态压降的计算不考虑电流随时间的变化，或者说以很长一段时间内的平均电流代指instance的电流。</p><p>R值的计算也相对简单，不会过多考虑电流趋肤效应对电阻的影响，主要考虑电源网络的结构和连线细节。可以由PG网络抽取出R值，并认为它也是恒定不变的。</p><p>这样，IR相乘得出静态压降也是一个不变量，算静态压降的意义在于可以快速评估芯片的PG网络如何，powerplan是否做的足够好。如果出现许多static IR的violation，可能就需要重新调整PG网络。那么，static IR的这个平均电流是如何得到的呢？实际上，我们是先利用primepower等算power的工具先算出instance的power值，再根据power和instance的电阻得出流过他的电流。</p><h3 id="动态-ir-压降" tabindex="-1"><a class="header-anchor" href="#动态-ir-压降" aria-hidden="true">#</a> 动态 IR 压降</h3><p>而动态 IR 压降是指当输入连续切换时（即电路处于功能状态）电流波动引起的电源传输网络中的电压降。动态IR drop是电源在电路开关切换的时候电流波动引起的电压压降。这种现象产生在时钟的触发沿，时钟沿跳变不仅带来自身的大量晶体管开关，同时带来组合逻辑电路的跳变，往往在短时间内在整个芯片上产生很大的电流，这个瞬间的大电流引起了IR drop现象。同时开关的晶体管数量越多，越容易触发动态IR drop现象。</p><p><strong>动态 IR 压降取决于实例的切换速率。</strong> Dynamic IR的计算相对复杂，它考虑了电流随时间的变化，通过对芯片长时间的模拟，可以认为某个instance的电流是随时间周期性变化的，相应的它的IR drop也会是一个随时间变化的函数。</p><p>一般会有三个比较关心的指标：peak IR、average IR、RMS IR。Peak IR即为电压降的峰值，我们需要保证峰值压降也在可接受范围内。Average IR指的是每个周期的平均压降，其实也有点类似static IR，但是计算方式会有所差异。RMS IR指root mean squre IR，也就是算IR drop随时间变化的方差，有的时候我们需要保证instance的电压降要平缓的变化，RMS就可以反映电压降随时间的离散程度。一般来说，dynamic IR的计算耗时很长，适用于找到个别instance的violation，而后针对性的调整某个instance。可以挪动它的位置到IR比较好的区域，也可以针对性的在某一块补一些PG mesh。</p><p>当输入连续切换时，实例中会流动更多的电流，同时也会在PDN中流动更多的电流。因此，在PDN中会有更多的 IR 压降。因此，动态 IR 压降大于静态 IR 压降。</p><h2 id="ir-压降的原因" tabindex="-1"><a class="header-anchor" href="#ir-压降的原因" aria-hidden="true">#</a> IR 压降的原因</h2><p>IR 压降可能由于各种原因而发生，但主要原因有以下一些。</p><ul><li>电源传输网络设计不佳（金属宽度较小，电源条纹之间间距较大）</li><li>电源传输网络中适当数量的过孔不足</li><li>解耦电容单元（DeCap Cell）的数量不足</li><li>特定区域中高细胞密度和高开关</li><li>电源传输网络的高阻抗</li><li>突发电流</li><li>电压源数量不足</li><li>用于创建电源传输网络的金属层的高 RC 值</li></ul><h2 id="ir-压降的影响" tabindex="-1"><a class="header-anchor" href="#ir-压降的影响" aria-hidden="true">#</a> IR 压降的影响</h2><p>标准单元的延迟取决于单元的可用电源，如果电源供应减少，则单元的延迟增加。 单元延迟的增加可能影响设计的性能。如果标准单元的可用电压降至特定水平以下，则单元可能完全停止运行，导致设计的功能故障。 或者有时，IR 压降在限制范围内只会增加单元的延迟，从而影响设计的建立和保持时间，并有时导致建立时间（setup time）和保持时间（hold time）违例。setup的违例，可以通过抬高电压来提升频率，但是代价是功耗上去了，而且如果动态IR drop不够robust，可能通过抬电压，setup能提升的空间也有限。而一旦出现hold违例，那芯片就无法正常工作。因此在先进工艺中，IR drop的影响特别大，需要引起各位的高度重视。</p><p>如果由于某个特定区域的大量开关活动，导致当前需求突然增加，VDD 线路也可能会突然下降。此类 VDD 水平下降称为<strong>电压下降</strong>。或可能会导致地线电压水平突然升高，称为<strong>地弹跳</strong>。这些统称为<strong>电源噪声</strong>。 图2 显示了由于 IR 压降导致的电源噪声。</p><div style="text-align:center;"><img src="'+d+'" alt="ASIC Flow" width="600"><h5>图2 由于 IR 压降导致的电源噪声</h5></div><p>简而言之，IR 压降可能导致：</p><ul><li>单元延迟的变化</li><li>可能违反建立和保持时间</li><li>引入电源噪声到电源网络</li></ul><h2 id="ir-分析和修复" tabindex="-1"><a class="header-anchor" href="#ir-分析和修复" aria-hidden="true">#</a> IR 分析和修复：</h2><p>每家 EDA 公司都有自己的 IR 分析工具，该工具执行 IR 分析，并基于分析应用 IR 修复技术。工业中使用的两种最流行的 IR 分析工具是：</p><ul><li>Ansys 的 RedHawk</li><li>Cadence Design System 的 Voltus</li></ul><p>根据分析，会应用各种修复 IR 压降的技术。通常执行的一些修复措施包括：</p><ul><li>插入足够数量的解耦电容单元（DeCap Cell），以增强电源传输网络。</li><li>如果电源传输网络构建不正确，重新构建电源传输网络。我们可以增加金属条纹的宽度或减小它们之间的间距。</li><li>我们可以在一个区域内扩展逻辑单元，以便负载可以分布。</li></ul><p>更多解耦电容单元的知识，可以查看第5部分第4节。</p><h2 id="谢谢" tabindex="-1"><a class="header-anchor" href="#谢谢" aria-hidden="true">#</a> 谢谢</h2>',31),m={href:"https://teamvlsi.com/2020/07/ir-analysis-in-asic-design-effects-and.html",target:"_blank",rel:"noopener noreferrer"},f=i("br",null,null,-1),g={href:"https://zhuanlan.zhihu.com/p/450521738",target:"_blank",rel:"noopener noreferrer"},V=i("br",null,null,-1),b={href:"https://zhuanlan.zhihu.com/p/544002432",target:"_blank",rel:"noopener noreferrer"};function x(D,v){const l=n("big"),o=n("center"),r=n("ExternalLinkIcon");return c(),R("div",null,[_,a(o,null,{default:t(()=>[i("b",null,[a(l,null,{default:t(()=>[e("V2 = V1 - I.R")]),_:1})])]),_:1}),u,i("p",null,[e("[1] "),i("a",m,[e("https://teamvlsi.com/2020/07/ir-analysis-in-asic-design-effects-and.html"),a(r)]),f,e(" [2] "),i("a",g,[e("https://zhuanlan.zhihu.com/p/450521738"),a(r)]),V,e(" [3] "),i("a",b,[e("https://zhuanlan.zhihu.com/p/544002432"),a(r)])])])}const S=h(I,[["render",x],["__file","4_2_IR降压分析.html.vue"]]);export{S as default};
